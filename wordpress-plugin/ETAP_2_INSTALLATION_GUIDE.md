# –≠–¢–ê–ü 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Endpoint /user/client

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å endpoint `/user/client` –≤ WordPress –ø–ª–∞–≥–∏–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–º —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º.

---

## üìã –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

- ‚úÖ WordPress –ø–ª–∞–≥–∏–Ω `bazarbuy-cabinet` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –≠–¢–ê–ü 1 –≤—ã–ø–æ–ª–Ω–µ–Ω (endpoint `/auth/me` —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ –ö–ª–∞—Å—Å `Bazarbuy_Response` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø–ª–∞–≥–∏–Ω–µ

---

## üîß –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –£–°–¢–ê–ù–û–í–ö–ï

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª** `includes/api/class-user-controller.php` –≤ –ø–∞–ø–∫—É –≤–∞—à–µ–≥–æ WordPress –ø–ª–∞–≥–∏–Ω–∞:
   ```
   wp-content/plugins/bazarbuy-cabinet/includes/api/class-user-controller.php
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
   ```
   bazarbuy-cabinet/
   ‚îú‚îÄ‚îÄ bazarbuy-cabinet.php (–≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª)
   ‚îú‚îÄ‚îÄ includes/
   ‚îÇ   ‚îú‚îÄ‚îÄ api/
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ class-user-controller.php  ‚Üê –ù–û–í–´–ô –§–ê–ô–õ
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ class-profile-controller.php
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
   ‚îÇ   ‚îî‚îÄ‚îÄ ...
   ‚îî‚îÄ‚îÄ ...
   ```

---

### –®–∞–≥ 2: –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤ –≥–ª–∞–≤–Ω–æ–º —Ñ–∞–π–ª–µ –ø–ª–∞–≥–∏–Ω–∞

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª **`bazarbuy-cabinet.php`** –∏ –Ω–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é, –≥–¥–µ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫–ª–∞—Å—Å—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤.

#### 2.1 –î–æ–±–∞–≤–∏—Ç—å require_once –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

–ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é, –≥–¥–µ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (–æ–±—ã—á–Ω–æ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ –∏–ª–∏ –≤ –º–µ—Ç–æ–¥–µ `__construct()`):

```php
// –ù–ê–ô–¢–ò –≠–¢–û (–ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫):
require_once plugin_dir_path(__FILE__) . 'includes/api/class-profile-controller.php';
require_once plugin_dir_path(__FILE__) . 'includes/api/class-auth-controller.php';

// –î–û–ë–ê–í–ò–¢–¨ –ü–û–°–õ–ï:
require_once plugin_dir_path(__FILE__) . 'includes/api/class-user-controller.php';
```

#### 2.2 –°–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

–ù–∞–π–¥–∏—Ç–µ –º–µ—Å—Ç–æ, –≥–¥–µ —Å–æ–∑–¥–∞—é—Ç—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤:

```php
// –ù–ê–ô–¢–ò –≠–¢–û (–ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫):
$profile_controller = new Bazarbuy_Profile_Controller();
$auth_controller = new Bazarbuy_Auth_Controller();

// –î–û–ë–ê–í–ò–¢–¨ –ü–û–°–õ–ï:
$user_controller = new Bazarbuy_User_Controller();
```

#### 2.3 –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã

–ù–∞–π–¥–∏—Ç–µ —Ö—É–∫ `rest_api_init`, –≥–¥–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è endpoints:

```php
add_action('rest_api_init', function() use ($profile_controller, $auth_controller) {
    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö endpoints
    $profile_controller->register_routes();
    $auth_controller->register_routes();
    
    // –î–û–ë–ê–í–ò–¢–¨:
    global $user_controller; // –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å —á–µ—Ä–µ–∑ use()
    $user_controller->register_routes();
});
```

**–ò–õ–ò** –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥:

```php
// –ù–ê–ô–¢–ò –ú–ï–°–¢–û, –≥–¥–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è routes:
register_rest_route('cabinet/v1', '/auth/login', [...]);
register_rest_route('cabinet/v1', '/user/profile', [...]);

// –î–û–ë–ê–í–ò–¢–¨:
$user_controller = new Bazarbuy_User_Controller();
$user_controller->register_routes();
```

**–ò–õ–ò** –Ω–∞–ø—Ä—è–º—É—é –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å endpoint:

```php
register_rest_route('cabinet/v1', '/user/client', [
    'methods'             => 'GET',
    'callback'            => [$user_controller, 'get_client'],
    'permission_callback' => [$user_controller, 'check_auth'],
]);
```

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–ª–∞—Å—Å–∞ Bazarbuy_Response

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–ª–∞–≥–∏–Ω–µ –µ—Å—Ç—å –∫–ª–∞—Å—Å `Bazarbuy_Response` —Å –º–µ—Ç–æ–¥–∞–º–∏:
- `success_response($data)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
- `error_response($code, $message, $status_code)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

–ï—Å–ª–∏ –∫–ª–∞—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω–∞—á–µ –∏–ª–∏ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç –¥—Ä—É–≥–∏–µ –∏–º–µ–Ω–∞, **–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ** `class-user-controller.php`:

```php
// –í –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ (—Å—Ç—Ä–æ–∫–∞ ~20):
// –ï—Å–ª–∏ –∫–ª–∞—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è Bazarbuy_Response_Helper:
$this->response = new Bazarbuy_Response_Helper();

// –ò–ª–∏ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã:
// –£–¥–∞–ª–∏—Ç–µ $this->response –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
// Bazarbuy_Response::success($data);
```

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–í —Ñ–∞–π–ª–µ `class-user-controller.php` –º–µ—Ç–æ–¥ `check_auth()` –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–ª–∞–≥–∏–Ω–∞.

**–ï—Å–ª–∏ –≤ –ø–ª–∞–≥–∏–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ JWT:**

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –º–µ—Ç–æ–¥ `check_auth()` (—Å—Ç—Ä–æ–∫–∞ ~50):

```php
public function check_auth() {
    // –í–ê–†–ò–ê–ù–¢ 1: –ï—Å–ª–∏ –µ—Å—Ç—å –∫–ª–∞—Å—Å Bazarbuy_JWT:
    if (class_exists('Bazarbuy_JWT')) {
        return Bazarbuy_JWT::validate_token();
    }
    
    // –í–ê–†–ò–ê–ù–¢ 2: –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –≥–ª–∞–≤–Ω–æ–º —Ñ–∞–π–ª–µ –ø–ª–∞–≥–∏–Ω–∞:
    // –ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JWT (–Ω–∞–ø—Ä–∏–º–µ—Ä, check_jwt_permission)
    // –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ:
    $main_plugin = Bazarbuy_Cabinet::get_instance();
    return $main_plugin->check_jwt_permission();
    
    // –í–ê–†–ò–ê–ù–¢ 3: Fallback (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é):
    return is_user_logged_in();
}
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ endpoint

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ endpoint –¥–æ—Å—Ç—É–ø–µ–Ω (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 401)
curl -X GET https://your-domain.com/wp/wp-json/cabinet/v1/user/client \
  -H "Content-Type: application/json"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** `401 Unauthorized`

---

### –¢–µ—Å—Ç 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å JWT —Ç–æ–∫–µ–Ω–æ–º

1. **–°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω** —á–µ—Ä–µ–∑ `/auth/login`:

```bash
curl -X POST https://your-domain.com/wp/wp-json/cabinet/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "your_password"
  }'
```

**–û—Ç–≤–µ—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**
```json
{
  "success": true,
  "token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
  "user": {...}
}
```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ `/user/client`:**

```bash
curl -X GET https://your-domain.com/wp/wp-json/cabinet/v1/user/client \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE" \
  -H "Content-Type: application/json"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç (200 OK):**
```json
{
  "success": true,
  "data": {
    "id": "1",
    "clientId": "BB-00001",
    "email": "test@example.com",
    "authProvider": "email",
    "emailVerified": false,
    "name": "Test User",
    "city": "",
    "phone": "",
    "isAuthenticated": true,
    "isFirstLogin": true,
    "createdAt": "2025-01-10T10:22:00+00:00",
    "lastLoginAt": null
  }
}
```

---

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

1. **–í `cabinet-api.js` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:**
   ```javascript
   CONFIG.useMock = false;
   CONFIG.baseURL = 'https://your-domain.com/wp/wp-json/cabinet/v1';
   ```

2. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–±–∏–Ω–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:**
   - –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
   - –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ (F12)
   - –ü—Ä–æ—Ñ–∏–ª—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üîß –ê–î–ê–ü–¢–ê–¶–ò–Ø –ü–û–î –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô –ö–û–î

–ï—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞—à–µ–≥–æ –ø–ª–∞–≥–∏–Ω–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è, –≤–æ—Ç –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏:

### 1. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ–∂–∏–¥–∞–µ—Ç –ª–∏–±–æ:
```json
{
  "success": true,
  "data": {...}
}
```

–õ–∏–±–æ –Ω–∞–ø—Ä—è–º—É—é –æ–±—ä–µ–∫—Ç –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ WordPress –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–µ–∑ –æ–±—ë—Ä—Ç–∫–∏).

**–ï—Å–ª–∏ WordPress –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–µ–∑ `success` –∏ `data`**, –æ–±–Ω–æ–≤–∏—Ç–µ `cabinet-api.js`:

```javascript
async getClient() {
    const result = await request('GET', CONFIG.endpoints.client);
    
    // –ê–¥–∞–ø—Ç–∞—Ü–∏—è: –µ—Å–ª–∏ WordPress –≤–µ—Ä–Ω—É–ª –Ω–∞–ø—Ä—è–º—É—é –¥–∞–Ω–Ω—ã–µ
    if (result.id || result.clientId) {
        return result;
    }
    
    // –ï—Å–ª–∏ –≤ –æ–±—ë—Ä—Ç–∫–µ { success, data }
    if (result.success && result.data) {
        return result.data;
    }
    
    return result;
},
```

### 2. –§–æ—Ä–º–∞—Ç clientId

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ—Ñ–∏–∫—Å `BB-` (BazarBuy). –ï—Å–ª–∏ –Ω—É–∂–µ–Ω `CL-`, –∏–∑–º–µ–Ω–∏—Ç–µ –≤ `class-user-controller.php` (—Å—Ç—Ä–æ–∫–∞ ~60):

```php
$client_id = 'CL-' . str_pad($user_id, 5, '0', STR_PAD_LEFT);
```

### 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞

–õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `isFirstLogin` –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –º–µ—Ç–∞-–ø–æ–ª–µ `bazarbuy_profile_completed`. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∞—è –ª–æ–≥–∏–∫–∞, –∏–∑–º–µ–Ω–∏—Ç–µ (—Å—Ç—Ä–æ–∫–∞ ~90):

```php
// –í–ê–†–ò–ê–ù–¢ 1: –ü–æ –º–µ—Ç–∞-–ø–æ–ª—é is_first_login
$is_first_login = get_user_meta($user_id, 'bazarbuy_first_login', true) !== 'false';

// –í–ê–†–ò–ê–ù–¢ 2: –ü–æ –Ω–∞–ª–∏—á–∏—é –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è
$has_profile = !empty(get_user_meta($user_id, 'bazarbuy_name', true));
$is_first_login = !$has_profile;

// –í–ê–†–ò–ê–ù–¢ 3: –í—Å–µ–≥–¥–∞ false –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞
$is_first_login = false;
```

---

## ‚ö†Ô∏è –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "Class 'Bazarbuy_Response' not found"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª–∞—Å—Å `Bazarbuy_Response` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø–ª–∞–≥–∏–Ω–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–Ω –ø–æ–¥–∫–ª—é—á—ë–Ω –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è `Bazarbuy_User_Controller`
3. –ò–∑–º–µ–Ω–∏—Ç–µ –∏–º—è –∫–ª–∞—Å—Å–∞ –≤ `class-user-controller.php`, –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "401 Unauthorized" –¥–∞–∂–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç–æ–¥ `check_auth()` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–∏ –æ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—É—é JWT –ø—Ä–æ–≤–µ—Ä–∫—É
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer TOKEN` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ JWT —Å–µ–∫—Ä–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `wp-config.php`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Endpoint –Ω–µ –Ω–∞–π–¥–µ–Ω (404)

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∞—Ä—à—Ä—É—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `rest_api_init`
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–±—Ä–æ—Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ WordPress:
   ```bash
   wp rewrite flush
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–µ—Ñ–∏–∫—Å namespace –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: `cabinet/v1`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ CURL
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –º–µ—Ç–æ–¥ `getClient()` –≤ `cabinet-api.js` (—Å–º. —Ä–∞–∑–¥–µ–ª "–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥")

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø

- [ ] –§–∞–π–ª `class-user-controller.php` —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –ø–ª–∞–≥–∏–Ω
- [ ] –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ–¥–∫–ª—é—á—ë–Ω —á–µ—Ä–µ–∑ `require_once` –≤ –≥–ª–∞–≤–Ω–æ–º —Ñ–∞–π–ª–µ
- [ ] –°–æ–∑–¥–∞–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä `Bazarbuy_User_Controller`
- [ ] –ú–µ—Ç–æ–¥ `register_routes()` –≤—ã–∑–≤–∞–Ω –≤ `rest_api_init`
- [ ] Endpoint –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ CURL (401 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞, 200 —Å —Ç–æ–∫–µ–Ω–æ–º)
- [ ] –î–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- [ ] –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤—ã–º endpoint (–ø—Ä–∏ `useMock = false`)

---

## üìä –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≠–¢–ê–ü–ê 2:

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é** —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
2. **–ü–µ—Ä–µ–π—Ç–∏ –∫ –≠–¢–ê–ü–£ 3:** –î–æ–±–∞–≤–∏—Ç—å endpoints –¥–ª—è —á–∞—Ç–∞ –∏ Telegram
3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ): –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## üìù –ò–¢–û–ì

**–≠–¢–ê–ü 2 –¥–æ–±–∞–≤–ª—è–µ—Ç:**
- ‚úÖ Endpoint `/user/client` –≤ WordPress
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º (—Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é `clientId`
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production

**–§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π** ‚Äî –æ–Ω —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/user/client` —á–µ—Ä–µ–∑ `cabinet-api.js`!


