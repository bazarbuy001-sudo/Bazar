# ‚úÖ –≠–¢–ê–ü 2 –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –ó–ê–í–ï–†–®–Å–ù

**–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2026-01-XX  
**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å endpoint `/user/client` –≤ WordPress –ø–ª–∞–≥–∏–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞

---

## üìã –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´

### ‚úÖ 1. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–§–∞–π–ª:** `wordpress-plugin/includes/api/class-user-controller.php`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –ö–ª–∞—Å—Å `Bazarbuy_User_Controller`
- –ú–µ—Ç–æ–¥ `get_client()` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞
- –ú–µ—Ç–æ–¥ `check_auth()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ú–µ—Ç–æ–¥ `register_routes()` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è endpoint

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `clientId` (—Ñ–æ—Ä–º–∞—Ç `BB-00001`)
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ –º–µ—Ç–∞-–ø–æ–ª—è
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ–æ—Ä–º–∞—Ç–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (`state.client`)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–ª–∞—Å—Å–∞ `Bazarbuy_Response`

---

### ‚úÖ 2. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

**–§–∞–π–ª:** `wordpress-plugin/ETAP_2_INSTALLATION_GUIDE.md`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –ø–ª–∞–≥–∏–Ω–∞
- –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–µ—à–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

---

## üéØ –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ

### Endpoint: `GET /wp-json/cabinet/v1/user/client`

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "success": true,
  "data": {
    "id": "1",
    "clientId": "BB-00001",
    "email": "user@example.com",
    "authProvider": "email",
    "emailVerified": false,
    "name": "–ò–º—è –§–∞–º–∏–ª–∏—è",
    "city": "–ì–æ—Ä–æ–¥",
    "phone": "+996700123456",
    "isAuthenticated": true,
    "isFirstLogin": true,
    "createdAt": "2025-01-10T10:22:00+00:00",
    "lastLoginAt": "2025-01-10T10:22:00+00:00"
  }
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- `401 Unauthorized` ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `404 Not Found` ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω

---

## üîß –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° WORDPRESS

### –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ WordPress:

1. **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞** –≤ –ø–ª–∞–≥–∏–Ω:
   ```
   wp-content/plugins/bazarbuy-cabinet/includes/api/class-user-controller.php
   ```

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä** –≤ –≥–ª–∞–≤–Ω–æ–º —Ñ–∞–π–ª–µ –ø–ª–∞–≥–∏–Ω–∞:
   ```php
   require_once plugin_dir_path(__FILE__) . 'includes/api/class-user-controller.php';
   ```

3. **–°–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å routes:**
   ```php
   $user_controller = new Bazarbuy_User_Controller();
   add_action('rest_api_init', function() use ($user_controller) {
       $user_controller->register_routes();
   });
   ```

---

## ‚úÖ –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨

### –§—Ä–æ–Ω—Ç–µ–Ω–¥:
- ‚úÖ **–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π** ‚Äî `cabinet-api.js` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/user/client`
- ‚úÖ **Mock-—Ä–µ–∂–∏–º** –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è** —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### WordPress:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–ª–∞—Å—Å `Bazarbuy_Response`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å –º–µ—Ç–∞-–ø–æ–ª—è–º–∏ –ø–ª–∞–≥–∏–Ω–∞ (`bazarbuy_*`)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
# 1. –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω
curl -X POST https://your-domain.com/wp/wp-json/cabinet/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password"}'

# 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞
curl -X GET https://your-domain.com/wp/wp-json/cabinet/v1/user/client \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json"
```

---

## üìä –ß–ï–ö–õ–ò–°–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø

- [x] –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å `Bazarbuy_User_Controller`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `get_client()`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `clientId`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞
- [x] –°–æ–∑–¥–∞–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
- [x] –°–æ–∑–¥–∞–Ω –≥–∞–π–¥ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- [ ] **–¢–†–ï–ë–£–ï–¢–°–Ø:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ WordPress –ø–ª–∞–≥–∏–Ω (–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞)
- [ ] **–¢–†–ï–ë–£–ï–¢–°–Ø:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º WordPress

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

–°–æ–∑–¥–∞–Ω –ø–æ–¥—Ä–æ–±–Ω—ã–π –≥–∞–π–¥ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:
- **`ETAP_2_SETUP_AND_TEST_GUIDE.md`** ‚Äî –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å –≥–æ—Ç–æ–≤—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –≠–¢–ê–ü 3: –ß–∞—Ç –∏ Telegram
- –°–æ–∑–¥–∞—Ç—å `class-chat-controller.php`
- –°–æ–∑–¥–∞—Ç—å `class-telegram-controller.php`
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å endpoints –≤ –ø–ª–∞–≥–∏–Ω–µ

---

## ‚úÖ –ò–¢–û–ì

**–≠–¢–ê–ü 2 –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!**

–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- ‚úÖ `wordpress-plugin/includes/api/class-user-controller.php` ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
- ‚úÖ `wordpress-plugin/ETAP_2_INSTALLATION_GUIDE.md` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- ‚úÖ `ETAP_2_INTEGRATION_COMPLETE.md` ‚Äî –æ—Ç—á—ë—Ç

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
- ‚è≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ –≤ WordPress –ø–ª–∞–≥–∏–Ω (–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞)
- ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CURL –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

**–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ WordPress:**
- ‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª—É—á–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ WordPress
- ‚úÖ Mock-—Ä–µ–∂–∏–º –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ –∫ –≠–¢–ê–ü–£ 3

